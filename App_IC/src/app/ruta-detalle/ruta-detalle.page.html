<ion-header>
  <ion-toolbar color="primary">
    <ion-buttons slot="start">
      <ion-button (click)="volver()">
        <ion-icon slot="icon-only" name="arrow-back"></ion-icon>
      </ion-button>
    </ion-buttons>
    <ion-title>Detalle de Ruta</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content>

  <div *ngIf="cargando" class="loading-container">
    <ion-spinner name="crescent" color="primary"></ion-spinner>
    <p>Cargando ruta...</p>
  </div>

  <div *ngIf="!cargando && ruta">

    <div id="map-detalle" class="mapa-detalle"></div>

    <ion-card class="info-card">
      <ion-card-header>
        <ion-card-title>{{ ruta.nombre_ruta }}</ion-card-title>
        <ion-card-subtitle>
          <ion-icon name="person-circle"></ion-icon>
          Creado por: {{ ruta.usuario_nombre || 'Usuario' }}
        </ion-card-subtitle>
      </ion-card-header>

      <ion-card-content>
        <p *ngIf="ruta.descripcion_ruta" class="descripcion">
          {{ ruta.descripcion_ruta }}
        </p>

        <div class="stats-grid">
          <div class="stat-box">
            <ion-icon name="flag" color="primary"></ion-icon>
            <div>
              <h3>{{ ruta.longitud_ruta || 0 }}</h3>
              <p>Kilómetros</p>
            </div>
          </div>

          <div class="stat-box">
            <ion-icon name="navigate-circle" color="success"></ion-icon>
            <div>
              <h3>{{ ruta.coordenadas?.length || 0 }}</h3>
              <p>Puntos GPS</p>
            </div>
          </div>

          <div class="stat-box">
            <ion-icon name="layers" color="warning"></ion-icon>
            <div>
              <h3>{{ ruta.nombre_tipo_ruta || 'GPS' }}</h3>
              <p>Tipo de ruta</p>
            </div>
          </div>
        </div>

        <div class="acciones">
          <ion-button expand="block" color="primary" (click)="iniciarRuta()">
            <ion-icon slot="start" name="navigate"></ion-icon>
            Iniciar Ruta
          </ion-button>

          <ion-button expand="block" fill="outline" color="secondary" (click)="compartirRuta()">
            <ion-icon slot="start" name="share-social"></ion-icon>
            Compartir ruta
          </ion-button>
        </div>
      </ion-card-content>
    </ion-card>

    <ion-card class="creador-card">
      <ion-card-header>
        <ion-card-title>Sobre el creador</ion-card-title>
      </ion-card-header>
      <ion-card-content>
        <div class="creador-info">
          <ion-icon name="person-circle" size="large" color="primary"></ion-icon>
          <div>
            <h3>{{ ruta.usuario_nombre || 'Usuario' }}</h3>
            <p>{{ ruta.usuario_correo || 'Colaborador de la comunidad' }}</p>
          </div>
        </div>
      </ion-card-content>
    </ion-card>

  </div>

  <div *ngIf="!cargando && !ruta" class="error-container">
    <ion-icon name="alert-circle" size="large" color="danger"></ion-icon>
    <h2>No se pudo cargar la ruta</h2>
    <p>La ruta solicitada no existe o ha sido eliminada</p>
    <ion-button color="primary" (click)="volver()">
      <ion-icon slot="start" name="arrow-back"></ion-icon>
      Volver atrás
    </ion-button>
  </div>

</ion-content>