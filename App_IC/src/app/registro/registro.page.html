<ion-header [translucent]="true">
  <ion-toolbar>
    <ion-buttons slot="start">
      <ion-menu-button></ion-menu-button>
    </ion-buttons>
    <ion-title>Registro</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content class="ion-padding">

  <h2 style="text-align:center; margin-bottom: 25px;">Crear cuenta</h2>

  <form #registroForm="ngForm" (ngSubmit)="onRegistrar()">

    <!-- Nombre -->
    <ion-item>
      <ion-label position="floating">Nombre</ion-label>
      <ion-input
        type="text"
        name="nombre"
        required
        minlength="3"
        pattern="^[a-zA-ZáéíóúÁÉÍÓÚñÑ\s]+$"
        [(ngModel)]="usuario.nombre"
        #nombreRef="ngModel">
      </ion-input>
    </ion-item>
    <ion-note color="danger" *ngIf="nombreRef.invalid && nombreRef.touched">
      El nombre es obligatorio y solo permite letras.
    </ion-note>

    <!-- Correo (FIX REAL) -->
    <ion-item>
      <ion-label position="floating">Correo</ion-label>
      <ion-input
        type="email"
        name="correo"
        required
        pattern="^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.(cl|com|net|org)$"
        [(ngModel)]="usuario.correo"
        #correoRef="ngModel">
      </ion-input>
    </ion-item>
    <ion-note color="danger" *ngIf="correoRef.invalid && correoRef.touched">
      Ingresa un correo válido (ejemplo: usuario@dominio.cl).
    </ion-note>

    <!-- Contraseña -->
    <ion-item>
      <ion-label position="floating">Contraseña</ion-label>
      <ion-input
        type="password"
        name="contrasena"
        required
        minlength="6"
        [(ngModel)]="usuario.contrasena"
        #passRef="ngModel">
      </ion-input>
    </ion-item>
    <ion-note color="danger" *ngIf="passRef.invalid && passRef.touched">
      La contraseña debe tener al menos 6 caracteres.
    </ion-note>

    <!-- Celular -->
    <ion-item>
      <ion-label position="floating">Celular (opcional)</ion-label>
      <ion-input
        type="tel"
        name="celular"
        pattern="^[0-9]{9,12}$"
        [(ngModel)]="usuario.celular"
        #celRef="ngModel">
      </ion-input>
    </ion-item>
    <ion-note color="danger" *ngIf="celRef.invalid && celRef.touched">
      Debe tener entre 9 y 12 dígitos.
    </ion-note>

    <!-- Foto -->
    <ion-item>
      <ion-label>Foto (opcional)</ion-label>
      <input type="file" accept="image/*" (change)="onFileSelected($event)">
    </ion-item>

    <!-- Discapacidad -->
    <ion-item>
      <ion-label>Tipo de discapacidad</ion-label>
      <ion-select
        name="discapacidad"
        required
        [(ngModel)]="usuario.Discapacidades_id_discapacidad"
        #discRef="ngModel">
        <ion-select-option *ngFor="let d of discapacidades" [value]="d.id_discapacidad">
          {{ d.tipo_discapacidad }}
        </ion-select-option>
      </ion-select>
    </ion-item>
    <ion-note color="danger" *ngIf="registroForm.submitted && discRef.invalid">
      Debes seleccionar una discapacidad.
    </ion-note>

    <!-- Botón -->
    <ion-button 
      expand="block"
      type="submit"
      style="margin-top: 30px;"
      [disabled]="registroForm.invalid">
      REGISTRARSE
    </ion-button>

  </form>

</ion-content>